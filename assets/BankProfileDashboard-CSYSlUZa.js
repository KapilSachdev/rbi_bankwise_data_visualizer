import{j as e,r as x,f as p,S as _,E as Q,u as L,g as W,a as H,P as K}from"./index-yCXnK4IG.js";import{T}from"./Typeahead-BDsaPYP_.js";function B(t){return t!==null&&typeof t=="object"&&"Infrastructure"in t}const X=(t,r)=>typeof t!="number"||typeof r!="number"||isNaN(t)||isNaN(r)?null:r===0?t===0?0:null:(t-r)/r*100,A=x.memo(({currentValue:t,previousValue:r})=>{const c=X(t,r);if(c===null||r===void 0||t===void 0||isNaN(r)||isNaN(t))return null;const a=t-r,h=a>0,l=a<0,n=a===0,o=h?"+":"-",d=h?"bg-success/10 text-success border-success":l?"bg-error/10 text-error border-error":"bg-base-200 text-base-content border-base-300",i=h?"":l?"rotate-180":"rotate-90",b=h?`Increased by ${p(a)} (${c.toFixed(1)}%) from last month`:l?`Decreased by ${p(Math.abs(a))} (${Math.abs(c).toFixed(1)}%) from last month`:"No change from last month";return e.jsxs("span",{className:`inline-flex items-center tooltip tooltip-bottom gap-1 px-2 py-0.5 rounded-selector border font-semibold text-xs shadow-sm ${d} transition-all duration-200`,"aria-label":b,"data-tip":b,children:[e.jsx("span",{className:"inline-flex items-center justify-center w-4 h-4 rounded-selector mr-1",children:e.jsx(_,{icon:"triangle",className:`w-3 h-3 ${i}`,"aria-hidden":"true"})}),n?"No change":e.jsxs(e.Fragment,{children:[o,p(Math.abs(a)),e.jsxs("span",{className:"text-sm opacity-70 ml-0.5",children:["(",o,Math.abs(c).toFixed(1),"%)"]})]})]})});A.displayName="MoMIndicator";const m=x.memo(({title:t,value:r,currentValueForMoM:c,previousValueForMoM:a})=>e.jsxs("div",{className:"stat place-items-center p-2 bg-transparent",children:[e.jsx("div",{className:"stat-title text-lg text-base-content",children:t}),e.jsx("div",{className:"stat-value text-lg tooltip","data-tip":p(r),children:p(r)||"-"}),e.jsx("div",{className:"stat-desc flex items-center gap-2",children:e.jsx(A,{currentValue:c,previousValue:a})})]}));m.displayName="StatItem";const Y=[{title:"Credit Cards",valuePath:t=>t.Infrastructure?.Credit_Cards},{title:"Debit Cards",valuePath:t=>t.Infrastructure?.Debit_Cards},{title:"UPI QR Codes",valuePath:t=>t.Infrastructure?.UPI_QR_Codes},{title:"Bharat QR Codes",valuePath:t=>t.Infrastructure?.Bharat_QR_Codes},{title:"PoS Terminals",valuePath:t=>t.Infrastructure?.PoS},{title:"On-site ATMs",valuePath:t=>t.Infrastructure?.ATMs_CRMs?.On_site},{title:"Off-site ATMs",valuePath:t=>t.Infrastructure?.ATMs_CRMs?.Off_site},{title:"Micro ATMs",valuePath:t=>t.Infrastructure?.Micro_ATMs}],Z=({currentMonth:t,selectedBankData:r,prevMonthBankData:c,digitalBankingData:a})=>{if(!r)return null;const h=B(r),l=c&&B(c),n=a?.neft,o=a?.rtgs,d=a?.mobile,i=a?.internet;return e.jsx("div",{className:"card bg-base-100 shadow-xl border border-base-300",children:e.jsxs("div",{className:"card-body",children:[h&&e.jsxs("div",{className:"mb-8",children:[e.jsx("h3",{className:"font-bold text-lg mb-2",children:"ATM / PoS / Card Infrastructure"}),e.jsx("div",{className:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-4 gap-4 p-2 rounded-selector",children:Y.map((b,C)=>e.jsx(m,{title:b.title,value:b.valuePath(r),currentValueForMoM:b.valuePath(r),previousValueForMoM:l?b.valuePath(c):void 0},b.title))})]}),e.jsxs("div",{className:"mb-8",children:[e.jsx("h3",{className:"font-bold text-lg mb-2",children:"Digital Banking Overview"}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4",children:[e.jsxs("div",{className:"rounded-selector p-4 h-full flex flex-col",children:[e.jsx("h4",{className:"font-semibold mb-2 text-center",children:"NEFT"}),n?.current?e.jsxs("div",{className:"flex flex-col gap-2 flex-1",children:[e.jsx(m,{title:"Inward Credits (No.)",value:n.current.Received_Inward_Credits.No,currentValueForMoM:n.current.Received_Inward_Credits.No,previousValueForMoM:n.prev?.Received_Inward_Credits.No}),e.jsx(m,{title:"Inward Credits (Amount)",value:n.current.Received_Inward_Credits.Amount,currentValueForMoM:n.current.Received_Inward_Credits.Amount,previousValueForMoM:n.prev?.Received_Inward_Credits.Amount}),e.jsx(m,{title:"Outward Debits (No.)",value:n.current.Total_Outward_Debits.No,currentValueForMoM:n.current.Total_Outward_Debits.No,previousValueForMoM:n.prev?.Total_Outward_Debits.No}),e.jsx(m,{title:"Outward Debits (Amount)",value:n.current.Total_Outward_Debits.Amount,currentValueForMoM:n.current.Total_Outward_Debits.Amount,previousValueForMoM:n.prev?.Total_Outward_Debits.Amount})]}):e.jsx("div",{className:"text-center text-base-content/60",children:"No data"})]}),e.jsxs("div",{className:"rounded-selector p-4 h-full flex flex-col",children:[e.jsx("h4",{className:"font-semibold mb-2 text-center",children:"RTGS"}),o?.current?e.jsxs("div",{className:"flex flex-col gap-2 flex-1",children:[e.jsx(m,{title:"Outward Txns (No.)",value:o.current.Outward_Transactions.No,currentValueForMoM:o.current.Outward_Transactions.No,previousValueForMoM:o.prev?.Outward_Transactions.No}),e.jsx(m,{title:"Outward Txns (Amount)",value:o.current.Outward_Transactions.Amount,currentValueForMoM:o.current.Outward_Transactions.Amount,previousValueForMoM:o.prev?.Outward_Transactions.Amount}),e.jsx(m,{title:"Inward Txns (No.)",value:o.current.Inward_Transactions.No,currentValueForMoM:o.current.Inward_Transactions.No,previousValueForMoM:o.prev?.Inward_Transactions.No}),e.jsx(m,{title:"Inward Txns (Amount)",value:o.current.Inward_Transactions.Amount,currentValueForMoM:o.current.Inward_Transactions.Amount,previousValueForMoM:o.prev?.Inward_Transactions.Amount})]}):e.jsx("div",{className:"text-center text-base-content/60",children:"No data"})]}),e.jsxs("div",{className:"rounded-selector p-4 h-full flex flex-col",children:[e.jsx("h4",{className:"font-semibold mb-2 text-center",children:"Mobile Banking"}),d?.current?e.jsxs("div",{className:"flex flex-col gap-2 flex-1",children:[e.jsx(m,{title:"Volume",value:d.current.Volume,currentValueForMoM:d.current.Volume,previousValueForMoM:d.prev?.Volume}),e.jsx(m,{title:"Value",value:d.current.Value,currentValueForMoM:d.current.Value,previousValueForMoM:d.prev?.Value}),e.jsx(m,{title:"Active Customers",value:d.current.Active_Customers,currentValueForMoM:d.current.Active_Customers,previousValueForMoM:d.prev?.Active_Customers})]}):e.jsx("div",{className:"text-center text-base-content/60",children:"No data"})]}),e.jsxs("div",{className:"rounded-selector p-4 h-full flex flex-col",children:[e.jsx("h4",{className:"font-semibold mb-2 text-center",children:"Internet Banking"}),i?.current?e.jsxs("div",{className:"flex flex-col gap-2 flex-1",children:[e.jsx(m,{title:"Volume",value:i.current.Volume,currentValueForMoM:i.current.Volume,previousValueForMoM:i.prev?.Volume}),e.jsx(m,{title:"Value",value:i.current.Value,currentValueForMoM:i.current.Value,previousValueForMoM:i.prev?.Value}),e.jsx(m,{title:"Active Customers",value:i.current.Active_Customers,currentValueForMoM:i.current.Active_Customers,previousValueForMoM:i.prev?.Active_Customers})]}):e.jsx("div",{className:"text-center text-base-content/60",children:"No data"})]})]})]})]})})},q=({bankName:t,bankData:r,months:c,metrics:a})=>{const h=x.useRef(null),l=x.useMemo(()=>{const n=a.map(o=>({name:o.replace(/_/g," "),type:"line",smooth:!0,showSymbol:!1,data:r.map(d=>d.Infrastructure?.[o]??null)}));return{backgroundColor:"transparent",tooltip:{trigger:"axis",axisPointer:{type:"line"}},legend:{top:10,textStyle:{fontWeight:600}},grid:{left:40,right:20,top:50,bottom:40},xAxis:{type:"category",data:c,axisLabel:{rotate:45,fontWeight:500}},yAxis:{type:"value",axisLabel:{fontWeight:500}},series:n}},[r,a,c]);return e.jsx("div",{className:"card bg-base-100 shadow border-base-300 mb-8",children:e.jsxs("div",{className:"card-body",children:[e.jsxs("h3",{className:"card-title text-xl font-bold mb-2",children:[t," - Monthly Trends"]}),e.jsx(Q,{option:l,className:"w-full h-[400px]","aria-label":`${t} - Monthly trends for ${a.map(n=>n.replace(/_/g," ")).join(", ")}`,role:"img",tabIndex:0,onInit:n=>{h.current=n}})]})})},te=()=>{const{months:t,posBanksData:r,digitalBankingData:c}=L(),[a,h]=x.useState(""),[l,n]=x.useState("");x.useEffect(()=>{t.length>0&&!a&&h(t[0]);const s=r[a]||[];s.length>0?(!l||!s.some(v=>v.Bank_Name===l))&&n(s[0].Bank_Name):l&&n("")},[t,a,r]);const o=x.useMemo(()=>{const s=W(a,t),v=r[a]||[],k=v.find(u=>u.Bank_Name===l)||null,w=[...t].slice().reverse().map(u=>({month:u,data:r[u]?.find(f=>f.Bank_Name===l)||null})).filter(u=>!!u.data),E=w.map(u=>u.month),$=w.map(u=>u.data),G=s&&r[s]?.find(u=>u.Bank_Name===l)||null,I=u=>{const f=u?c[u]||{}:{};return{neft:Array.isArray(f.NEFT)&&f.NEFT.find(M=>M.Bank_Name===l)||null,rtgs:Array.isArray(f.RTGS)&&f.RTGS.find(M=>M.Bank_Name===l)||null,mobile:Array.isArray(f.Mobile_Banking)&&f.Mobile_Banking.find(M=>M.Bank_Name===l)||null,internet:Array.isArray(f.Internet_Banking)&&f.Internet_Banking.find(M=>M.Bank_Name===l)||null}},g=I(a),j=I(s),U=v.map(u=>u.Bank_Name);return{prevMonth:s,banksForMonth:v,bankNames:U,selectedBankData:k,selectedBankTimeSeriesData:$,selectedBankTimeSeriesMonths:E,prevMonthBankData:G,digitalBanking:{neft:{current:g.neft,prev:j.neft},rtgs:{current:g.rtgs,prev:j.rtgs},mobile:{current:g.mobile,prev:j.mobile},internet:{current:g.internet,prev:j.internet}}}},[a,l,t,r,c]),{banksForMonth:d,selectedBankData:i,selectedBankTimeSeriesData:b,selectedBankTimeSeriesMonths:C,prevMonthBankData:F,digitalBanking:V}=o,N=x.useMemo(()=>d.map(s=>({label:s.Bank_Name,value:s.Bank_Name,shortName:s.Bank_Short_Name})),[d]),S=x.useMemo(()=>t.map(s=>({label:H(s),value:s})),[t]),y=x.useMemo(()=>N.find(s=>s.value===l)?.shortName||"",[N,l]),P=x.useCallback(s=>{const v=N.find(k=>k.shortName===s)?.value||"";v&&n(v)},[N]),D=x.useMemo(()=>N.filter(s=>["HDFC","ICICI","SBI","AXIS","KOTAK","IDFCFirst","INDUSIND","HSBC","AMEX","AUSFB"].includes(s.shortName||"")).map(s=>s.shortName).filter(Boolean),[N]),O=x.useCallback(()=>{const s=t.indexOf(a);s<t.length-1&&h(t[s+1])},[t,a]),R=x.useCallback(()=>{const s=t.indexOf(a);s>0&&h(t[s-1])},[t,a]);return e.jsxs("div",{className:"container mx-auto p-4 sm:p-8",children:[i&&e.jsx("div",{className:"card bg-base-100 shadow-xl border border-base-300 mb-8",children:e.jsx("div",{className:"card-body",children:e.jsxs("div",{className:"flex flex-col sm:flex-row sm:items-start sm:justify-between",children:[e.jsxs("div",{className:"flex flex-col gap-2",children:[e.jsx(T,{options:N,selectedValue:l,onSelect:n,placeholder:"Select Bank",triggerClassName:"card-title text-4xl font-extrabold cursor-text",inputClassName:"card-title text-4xl font-extrabold focus:outline-none"}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx("div",{className:"badge badge-xl bg-base-300 p-2",children:i?.Bank_Type}),e.jsx("div",{className:"badge badge-xl bg-base-300 p-2",children:i?.Bank_Short_Name})]}),e.jsx("div",{className:"grid",children:e.jsx(K,{bankTypes:D,selected:y,onSelect:P,showAll:!1})})]}),e.jsxs("div",{className:"flex items-center gap-2 mt-4 sm:mt-0",children:[e.jsx("button",{className:"btn btn-ghost btn-sm",onClick:O,disabled:t.indexOf(a)===t.length-1,"aria-label":"Previous Month",title:"Previous Month",children:e.jsx(_,{icon:"arrow",className:"w-5 h-5 rotate-270"})}),e.jsx("div",{className:"flex-1 min-w-0 w-full",children:e.jsx(T,{options:S,selectedValue:a,onSelect:h,placeholder:"Select Month",triggerClassName:"badge badge-info badge-lg justify-center",inputClassName:"focus:outline-none"})}),e.jsx("button",{className:"btn btn-ghost btn-sm",onClick:R,disabled:t.indexOf(a)===0,"aria-label":"Next Month",title:"Next Month",children:e.jsx(_,{icon:"arrow",className:"w-5 h-5 rotate-90"})})]})]})})}),i?e.jsxs("article",{className:"grid gap-4",children:[e.jsx(Z,{currentMonth:a,selectedBankData:i,prevMonthBankData:F,digitalBankingData:V}),e.jsx(q,{bankData:b,months:C,metrics:["ATMs_CRMs","PoS","Credit_Cards","Debit_Cards"],bankName:l,digitalBankingData:c})]}):e.jsxs("div",{role:"alert",className:"alert alert-info shadow-lg",children:[e.jsx(_,{icon:"info",className:"shrink-0 w-6 h-6","aria-label":"Info"}),e.jsxs("div",{children:[e.jsx("h3",{className:"font-bold",children:"No Bank Selected or Data Unavailable!"}),e.jsx("div",{className:"text-sm",children:"Please select a month and then a bank from the dropdowns above to view its profile."})]})]})]})};export{te as default};
