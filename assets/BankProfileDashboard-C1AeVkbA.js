import{j as e,r as m,S as I,E,u as G,g as U,f as Q,P as W}from"./index-CVkcjW0M.js";import{T as F}from"./Typeahead-D_KHX9yz.js";function M(t){if(t==null)return"";const r={style:"currency",currency:"INR",minimumFractionDigits:2,maximumFractionDigits:2};return new Intl.NumberFormat("en-IN",r).format(t)}function g(t,r=!0){if(t==null)return"";const n=typeof t=="string"?parseFloat(t):t;if(isNaN(n))return"";if(r){if(n>=1e7)return`${(n/1e7).toFixed(2).replace(/\.00$/,"")} Crore`;if(n>=1e5)return`${(n/1e5).toFixed(2).replace(/\.00$/,"")} Lakh`}return new Intl.NumberFormat("en-IN").format(n)}function T(t){return t!==null&&typeof t=="object"&&"Infrastructure"in t}const H=(t,r)=>typeof t!="number"||typeof r!="number"||isNaN(t)||isNaN(r)?null:r===0?t===0?0:null:(t-r)/r*100,A=m.memo(({currentValue:t,previousValue:r})=>{const n=H(t,r);if(n===null||r===void 0||t===void 0||isNaN(r)||isNaN(t))return null;const a=t-r,x=a>0,l=a<0,i=a===0,o=x?"+":"-",u=x?"bg-success/10 text-success border-success":l?"bg-error/10 text-error border-error":"bg-base-200 text-base-content border-base-300",c=x?"":l?"rotate-180":"rotate-90",f=x?`Increased by ${g(a,!1)} (${n.toFixed(1)}%) from last month`:l?`Decreased by ${g(Math.abs(a),!1)} (${Math.abs(n).toFixed(1)}%) from last month`:"No change from last month";return e.jsxs("span",{className:`inline-flex items-center tooltip tooltip-bottom gap-1 px-2 py-0.5 rounded-selector border font-semibold text-xs shadow-sm ${u} transition-all duration-200`,"aria-label":f,"data-tip":f,children:[e.jsx("span",{className:"inline-flex items-center justify-center w-4 h-4 rounded-selector mr-1",children:e.jsx(I,{icon:"triangle",className:`w-3 h-3 ${c}`,"aria-hidden":"true"})}),i?"No change":e.jsxs(e.Fragment,{children:[o,g(Math.abs(a)),e.jsxs("span",{className:"text-sm opacity-70 ml-0.5",children:["(",o,Math.abs(n).toFixed(1),"%)"]})]})]})});A.displayName="MoMIndicator";const d=m.memo(({title:t,value:r,currentValueForMoM:n,previousValueForMoM:a})=>e.jsxs("div",{className:"stat place-items-center p-2 bg-transparent",children:[e.jsx("div",{className:"stat-title text-lg text-base-content",children:t}),e.jsx("div",{className:"stat-value text-lg tooltip","data-tip":g(r,!1),children:g(r)||"-"}),e.jsx("div",{className:"stat-desc flex items-center gap-2",children:e.jsx(A,{currentValue:n,previousValue:a})})]}));d.displayName="StatItem";const K=[{title:"Credit Cards",valuePath:t=>t.Infrastructure?.Credit_Cards},{title:"Debit Cards",valuePath:t=>t.Infrastructure?.Debit_Cards},{title:"UPI QR Codes",valuePath:t=>t.Infrastructure?.UPI_QR_Codes},{title:"Bharat QR Codes",valuePath:t=>t.Infrastructure?.Bharat_QR_Codes},{title:"PoS Terminals",valuePath:t=>t.Infrastructure?.PoS},{title:"On-site ATMs",valuePath:t=>t.Infrastructure?.ATMs_CRMs?.On_site},{title:"Off-site ATMs",valuePath:t=>t.Infrastructure?.ATMs_CRMs?.Off_site},{title:"Micro ATMs",valuePath:t=>t.Infrastructure?.Micro_ATMs}],X=({currentMonth:t,selectedBankData:r,prevMonthBankData:n,digitalBankingData:a})=>{if(!r)return null;const x=T(r),l=n&&T(n),i=a?.neft,o=a?.rtgs,u=a?.mobile,c=a?.internet;return e.jsx("div",{className:"card bg-base-100 shadow-xl border border-base-300",children:e.jsxs("div",{className:"card-body",children:[x&&e.jsxs("div",{className:"mb-8",children:[e.jsx("h3",{className:"font-bold text-lg mb-2",children:"ATM / PoS / Card Infrastructure"}),e.jsx("div",{className:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-4 gap-4 p-2 rounded-selector",children:K.map((f,k)=>e.jsx(d,{title:f.title,value:f.valuePath(r),currentValueForMoM:f.valuePath(r),previousValueForMoM:l?f.valuePath(n):void 0},f.title))})]}),e.jsxs("div",{className:"mb-8",children:[e.jsx("h3",{className:"font-bold text-lg mb-2",children:"Digital Banking Overview"}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4",children:[e.jsxs("div",{className:"rounded-selector p-4 h-full flex flex-col",children:[e.jsx("h4",{className:"font-semibold mb-2 text-center",children:"NEFT"}),i?.current?e.jsxs("div",{className:"flex flex-col gap-2 flex-1",children:[e.jsx(d,{title:"Inward Credits (No.)",value:i.current.Received_Inward_Credits.No.toLocaleString(),currentValueForMoM:i.current.Received_Inward_Credits.No,previousValueForMoM:i.prev?.Received_Inward_Credits.No}),e.jsx(d,{title:"Inward Credits (Amount)",value:M(i.current.Received_Inward_Credits.Amount),currentValueForMoM:i.current.Received_Inward_Credits.Amount,previousValueForMoM:i.prev?.Received_Inward_Credits.Amount}),e.jsx(d,{title:"Outward Debits (No.)",value:i.current.Total_Outward_Debits.No.toLocaleString(),currentValueForMoM:i.current.Total_Outward_Debits.No,previousValueForMoM:i.prev?.Total_Outward_Debits.No}),e.jsx(d,{title:"Outward Debits (Amount)",value:M(i.current.Total_Outward_Debits.Amount),currentValueForMoM:i.current.Total_Outward_Debits.Amount,previousValueForMoM:i.prev?.Total_Outward_Debits.Amount})]}):e.jsx("div",{className:"text-center text-base-content/60",children:"No data"})]}),e.jsxs("div",{className:"rounded-selector p-4 h-full flex flex-col",children:[e.jsx("h4",{className:"font-semibold mb-2 text-center",children:"RTGS"}),o?.current?e.jsxs("div",{className:"flex flex-col gap-2 flex-1",children:[e.jsx(d,{title:"Outward Txns (No.)",value:o.current.Outward_Transactions.No.toLocaleString(),currentValueForMoM:o.current.Outward_Transactions.No,previousValueForMoM:o.prev?.Outward_Transactions.No}),e.jsx(d,{title:"Outward Txns (Amount)",value:M(o.current.Outward_Transactions.Amount),currentValueForMoM:o.current.Outward_Transactions.Amount,previousValueForMoM:o.prev?.Outward_Transactions.Amount}),e.jsx(d,{title:"Inward Txns (No.)",value:o.current.Inward_Transactions.No.toLocaleString(),currentValueForMoM:o.current.Inward_Transactions.No,previousValueForMoM:o.prev?.Inward_Transactions.No}),e.jsx(d,{title:"Inward Txns (Amount)",value:M(o.current.Inward_Transactions.Amount),currentValueForMoM:o.current.Inward_Transactions.Amount,previousValueForMoM:o.prev?.Inward_Transactions.Amount})]}):e.jsx("div",{className:"text-center text-base-content/60",children:"No data"})]}),e.jsxs("div",{className:"rounded-selector p-4 h-full flex flex-col",children:[e.jsx("h4",{className:"font-semibold mb-2 text-center",children:"Mobile Banking"}),u?.current?e.jsxs("div",{className:"flex flex-col gap-2 flex-1",children:[e.jsx(d,{title:"Volume",value:u.current.Volume.toLocaleString(),currentValueForMoM:u.current.Volume,previousValueForMoM:u.prev?.Volume}),e.jsx(d,{title:"Value",value:M(u.current.Value),currentValueForMoM:u.current.Value,previousValueForMoM:u.prev?.Value}),e.jsx(d,{title:"Active Customers",value:u.current.Active_Customers.toLocaleString(),currentValueForMoM:u.current.Active_Customers,previousValueForMoM:u.prev?.Active_Customers})]}):e.jsx("div",{className:"text-center text-base-content/60",children:"No data"})]}),e.jsxs("div",{className:"rounded-selector p-4 h-full flex flex-col",children:[e.jsx("h4",{className:"font-semibold mb-2 text-center",children:"Internet Banking"}),c?.current?e.jsxs("div",{className:"flex flex-col gap-2 flex-1",children:[e.jsx(d,{title:"Volume",value:c.current.Volume.toLocaleString(),currentValueForMoM:c.current.Volume,previousValueForMoM:c.prev?.Volume}),e.jsx(d,{title:"Value",value:M(c.current.Value),currentValueForMoM:c.current.Value,previousValueForMoM:c.prev?.Value}),e.jsx(d,{title:"Active Customers",value:c.current.Active_Customers.toLocaleString(),currentValueForMoM:c.current.Active_Customers,previousValueForMoM:c.prev?.Active_Customers})]}):e.jsx("div",{className:"text-center text-base-content/60",children:"No data"})]})]})]})]})})},Y=({bankName:t,bankData:r,months:n,metrics:a})=>{const x=m.useMemo(()=>[...n].sort(),[n]),l=m.useRef(null),i=m.useMemo(()=>{const o=a.map(u=>({name:u.replace(/_/g," "),type:"line",smooth:!0,showSymbol:!1,data:r.map(c=>c.Infrastructure?.[u]??null)}));return{backgroundColor:"transparent",tooltip:{trigger:"axis",axisPointer:{type:"line"}},legend:{top:10,textStyle:{fontWeight:600}},grid:{left:40,right:20,top:50,bottom:40},xAxis:{type:"category",data:x,axisLabel:{rotate:45,fontWeight:500}},yAxis:{type:"value",axisLabel:{fontWeight:500}},series:o}},[r,a,x]);return e.jsx("div",{className:"card bg-base-100 shadow border-base-300 mb-8",children:e.jsxs("div",{className:"card-body",children:[e.jsxs("h3",{className:"card-title text-xl font-bold mb-2",children:[t," - Monthly Trends"]}),e.jsx(E,{option:i,className:"w-full h-[400px]","aria-label":`${t} - Monthly trends for ${a.map(o=>o.replace(/_/g," ")).join(", ")}`,role:"img",tabIndex:0,onInit:o=>{l.current=o}})]})})},z=()=>{const{months:t,posBanksData:r,digitalBankingData:n}=G(),[a,x]=m.useState(""),[l,i]=m.useState("");m.useEffect(()=>{t.length>0&&!a&&x(t[0]);const s=r[a]||[];s.length>0?(!l||!s.some(N=>N.Bank_Name===l))&&i(s[0].Bank_Name):l&&i("")},[t,a,r]);const o=m.useMemo(()=>{const s=U(a,t),N=r[a]||[],C=N.find(h=>h.Bank_Name===l)||null,R=[...t].reverse().map(h=>r[h]?.find(b=>b.Bank_Name===l)||null).filter(h=>!!h),L=s&&r[s]?.find(h=>h.Bank_Name===l)||null,w=h=>{const b=h?n[h]||{}:{};return{neft:Array.isArray(b.NEFT)&&b.NEFT.find(p=>p.Bank_Name===l)||null,rtgs:Array.isArray(b.RTGS)&&b.RTGS.find(p=>p.Bank_Name===l)||null,mobile:Array.isArray(b.Mobile_Banking)&&b.Mobile_Banking.find(p=>p.Bank_Name===l)||null,internet:Array.isArray(b.Internet_Banking)&&b.Internet_Banking.find(p=>p.Bank_Name===l)||null}},j=w(a),_=w(s),$=N.map(h=>h.Bank_Name);return{prevMonth:s,banksForMonth:N,bankNames:$,selectedBankData:C,selectedBankTimeSeriesData:R,prevMonthBankData:L,digitalBanking:{neft:{current:j.neft,prev:_.neft},rtgs:{current:j.rtgs,prev:_.rtgs},mobile:{current:j.mobile,prev:_.mobile},internet:{current:j.internet,prev:_.internet}}}},[a,l,t,r,n]),{banksForMonth:u,selectedBankData:c,selectedBankTimeSeriesData:f,prevMonthBankData:k,digitalBanking:B}=o,v=m.useMemo(()=>u.map(s=>({label:s.Bank_Name,value:s.Bank_Name,shortName:s.Bank_Short_Name})),[u]),S=m.useMemo(()=>t.map(s=>({label:Q(s),value:s})),[t]),V=m.useMemo(()=>v.find(s=>s.value===l)?.shortName||"",[v,l]),y=m.useCallback(s=>{const N=v.find(C=>C.shortName===s)?.value||"";N&&i(N)},[v]),D=m.useMemo(()=>v.filter(s=>["HDFC","ICICI","SBI","AXIS","KOTAK","IDFCFirst","INDUSIND","HSBC","AMEX","AUSFB"].includes(s.shortName||"")).map(s=>s.shortName).filter(Boolean),[v]),P=m.useCallback(()=>{const s=t.indexOf(a);s<t.length-1&&x(t[s+1])},[t,a]),O=m.useCallback(()=>{const s=t.indexOf(a);s>0&&x(t[s-1])},[t,a]);return e.jsxs("div",{className:"container mx-auto p-4 sm:p-8",children:[c&&e.jsx("div",{className:"card bg-base-100 shadow-xl border border-base-300 mb-8",children:e.jsx("div",{className:"card-body",children:e.jsxs("div",{className:"flex flex-col sm:flex-row sm:items-start sm:justify-between",children:[e.jsxs("div",{className:"flex flex-col gap-2",children:[e.jsx(F,{options:v,selectedValue:l,onSelect:i,placeholder:"Select Bank",triggerClassName:"card-title text-4xl font-extrabold cursor-text",inputClassName:"card-title text-4xl font-extrabold focus:outline-none"}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx("div",{className:"badge badge-xl bg-base-300 p-2",children:c?.Bank_Type}),e.jsx("div",{className:"badge badge-xl bg-base-300 p-2",children:c?.Bank_Short_Name})]}),e.jsx("div",{className:"grid",children:e.jsx(W,{bankTypes:D,selected:V,onSelect:y,showAll:!1})})]}),e.jsxs("div",{className:"flex items-center gap-2 mt-4 sm:mt-0",children:[e.jsx("button",{className:"btn btn-ghost btn-sm",onClick:P,disabled:t.indexOf(a)===t.length-1,"aria-label":"Previous Month",title:"Previous Month",children:e.jsx(I,{icon:"arrow",className:"w-5 h-5 rotate-270"})}),e.jsx("div",{className:"flex-1 min-w-0 w-full",children:e.jsx(F,{options:S,selectedValue:a,onSelect:x,placeholder:"Select Month",triggerClassName:"badge badge-info badge-lg justify-center",inputClassName:"focus:outline-none"})}),e.jsx("button",{className:"btn btn-ghost btn-sm",onClick:O,disabled:t.indexOf(a)===0,"aria-label":"Next Month",title:"Next Month",children:e.jsx(I,{icon:"arrow",className:"w-5 h-5 rotate-90"})})]})]})})}),c?e.jsxs("article",{className:"grid gap-4",children:[e.jsx(X,{currentMonth:a,selectedBankData:c,prevMonthBankData:k,digitalBankingData:B}),e.jsx(Y,{bankData:f,months:t,metrics:["ATMs_CRMs","PoS","Credit_Cards","Debit_Cards"],bankName:l,digitalBankingData:n})]}):e.jsxs("div",{role:"alert",className:"alert alert-info shadow-lg",children:[e.jsx(I,{icon:"info",className:"shrink-0 w-6 h-6","aria-label":"Info"}),e.jsxs("div",{children:[e.jsx("h3",{className:"font-bold",children:"No Bank Selected or Data Unavailable!"}),e.jsx("div",{className:"text-sm",children:"Please select a month and then a bank from the dropdowns above to view its profile."})]})]})]})};export{z as default};
