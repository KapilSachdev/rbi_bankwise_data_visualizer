import{j as e,r as m,f as p,a as g,S as C,E as $,u as G,g as U,b as Q,P as W}from"./index-Dxw5BWNI.js";import{T}from"./Typeahead-Pa0Eyzmo.js";function A(t){return t!==null&&typeof t=="object"&&"Infrastructure"in t}const H=(t,r)=>typeof t!="number"||typeof r!="number"||isNaN(t)||isNaN(r)?null:r===0?t===0?0:null:(t-r)/r*100,B=m.memo(({currentValue:t,previousValue:r})=>{const u=H(t,r);if(u===null||r===void 0||t===void 0||isNaN(r)||isNaN(t))return null;const a=t-r,x=a>0,l=a<0,o=a===0,n=x?"+":"-",c=x?"bg-success/10 text-success border-success":l?"bg-error/10 text-error border-error":"bg-base-200 text-base-content border-base-300",i=x?"":l?"rotate-180":"rotate-90",b=x?`Increased by ${g(a)} (${u.toFixed(1)}%) from last month`:l?`Decreased by ${g(Math.abs(a))} (${Math.abs(u).toFixed(1)}%) from last month`:"No change from last month";return e.jsxs("span",{className:`inline-flex items-center tooltip tooltip-bottom gap-1 px-2 py-0.5 rounded-selector border font-semibold text-xs shadow-sm ${c} transition-all duration-200`,"aria-label":b,"data-tip":b,children:[e.jsx("span",{className:"inline-flex items-center justify-center w-4 h-4 rounded-selector mr-1",children:e.jsx(C,{icon:"triangle",className:`w-3 h-3 ${i}`,"aria-hidden":"true"})}),o?"No change":e.jsxs(e.Fragment,{children:[n,g(Math.abs(a)),e.jsxs("span",{className:"text-sm opacity-70 ml-0.5",children:["(",n,Math.abs(u).toFixed(1),"%)"]})]})]})});B.displayName="MoMIndicator";const d=m.memo(({title:t,value:r,currentValueForMoM:u,previousValueForMoM:a})=>e.jsxs("div",{className:"stat place-items-center p-2 bg-transparent",children:[e.jsx("div",{className:"stat-title text-lg text-base-content",children:t}),e.jsx("div",{className:"stat-value text-lg tooltip","data-tip":g(r),children:g(r)||"-"}),e.jsx("div",{className:"stat-desc flex items-center gap-2",children:e.jsx(B,{currentValue:u,previousValue:a})})]}));d.displayName="StatItem";const K=[{title:"Credit Cards",valuePath:t=>t.Infrastructure?.Credit_Cards},{title:"Debit Cards",valuePath:t=>t.Infrastructure?.Debit_Cards},{title:"UPI QR Codes",valuePath:t=>t.Infrastructure?.UPI_QR_Codes},{title:"Bharat QR Codes",valuePath:t=>t.Infrastructure?.Bharat_QR_Codes},{title:"PoS Terminals",valuePath:t=>t.Infrastructure?.PoS},{title:"On-site ATMs",valuePath:t=>t.Infrastructure?.ATMs_CRMs?.On_site},{title:"Off-site ATMs",valuePath:t=>t.Infrastructure?.ATMs_CRMs?.Off_site},{title:"Micro ATMs",valuePath:t=>t.Infrastructure?.Micro_ATMs}],X=({currentMonth:t,selectedBankData:r,prevMonthBankData:u,digitalBankingData:a})=>{if(!r)return null;const x=A(r),l=u&&A(u),o=a?.neft,n=a?.rtgs,c=a?.mobile,i=a?.internet;return e.jsx("div",{className:"card bg-base-100 shadow-xl border border-base-300",children:e.jsxs("div",{className:"card-body",children:[x&&e.jsxs("div",{className:"mb-8",children:[e.jsx("h3",{className:"font-bold text-lg mb-2",children:"ATM / PoS / Card Infrastructure"}),e.jsx("div",{className:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-4 gap-4 p-2 rounded-selector",children:K.map((b,I)=>e.jsx(d,{title:b.title,value:b.valuePath(r),currentValueForMoM:b.valuePath(r),previousValueForMoM:l?b.valuePath(u):void 0},b.title))})]}),e.jsxs("div",{className:"mb-8",children:[e.jsx("h3",{className:"font-bold text-lg mb-2",children:"Digital Banking Overview"}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4",children:[e.jsxs("div",{className:"rounded-selector p-4 h-full flex flex-col",children:[e.jsx("h4",{className:"font-semibold mb-2 text-center",children:"NEFT"}),o?.current?e.jsxs("div",{className:"flex flex-col gap-2 flex-1",children:[e.jsx(d,{title:"Inward Credits (No.)",value:o.current.Received_Inward_Credits.No.toLocaleString(),currentValueForMoM:o.current.Received_Inward_Credits.No,previousValueForMoM:o.prev?.Received_Inward_Credits.No}),e.jsx(d,{title:"Inward Credits (Amount)",value:p(o.current.Received_Inward_Credits.Amount),currentValueForMoM:o.current.Received_Inward_Credits.Amount,previousValueForMoM:o.prev?.Received_Inward_Credits.Amount}),e.jsx(d,{title:"Outward Debits (No.)",value:o.current.Total_Outward_Debits.No.toLocaleString(),currentValueForMoM:o.current.Total_Outward_Debits.No,previousValueForMoM:o.prev?.Total_Outward_Debits.No}),e.jsx(d,{title:"Outward Debits (Amount)",value:p(o.current.Total_Outward_Debits.Amount),currentValueForMoM:o.current.Total_Outward_Debits.Amount,previousValueForMoM:o.prev?.Total_Outward_Debits.Amount})]}):e.jsx("div",{className:"text-center text-base-content/60",children:"No data"})]}),e.jsxs("div",{className:"rounded-selector p-4 h-full flex flex-col",children:[e.jsx("h4",{className:"font-semibold mb-2 text-center",children:"RTGS"}),n?.current?e.jsxs("div",{className:"flex flex-col gap-2 flex-1",children:[e.jsx(d,{title:"Outward Txns (No.)",value:n.current.Outward_Transactions.No.toLocaleString(),currentValueForMoM:n.current.Outward_Transactions.No,previousValueForMoM:n.prev?.Outward_Transactions.No}),e.jsx(d,{title:"Outward Txns (Amount)",value:p(n.current.Outward_Transactions.Amount),currentValueForMoM:n.current.Outward_Transactions.Amount,previousValueForMoM:n.prev?.Outward_Transactions.Amount}),e.jsx(d,{title:"Inward Txns (No.)",value:n.current.Inward_Transactions.No.toLocaleString(),currentValueForMoM:n.current.Inward_Transactions.No,previousValueForMoM:n.prev?.Inward_Transactions.No}),e.jsx(d,{title:"Inward Txns (Amount)",value:p(n.current.Inward_Transactions.Amount),currentValueForMoM:n.current.Inward_Transactions.Amount,previousValueForMoM:n.prev?.Inward_Transactions.Amount})]}):e.jsx("div",{className:"text-center text-base-content/60",children:"No data"})]}),e.jsxs("div",{className:"rounded-selector p-4 h-full flex flex-col",children:[e.jsx("h4",{className:"font-semibold mb-2 text-center",children:"Mobile Banking"}),c?.current?e.jsxs("div",{className:"flex flex-col gap-2 flex-1",children:[e.jsx(d,{title:"Volume",value:c.current.Volume.toLocaleString(),currentValueForMoM:c.current.Volume,previousValueForMoM:c.prev?.Volume}),e.jsx(d,{title:"Value",value:p(c.current.Value),currentValueForMoM:c.current.Value,previousValueForMoM:c.prev?.Value}),e.jsx(d,{title:"Active Customers",value:c.current.Active_Customers.toLocaleString(),currentValueForMoM:c.current.Active_Customers,previousValueForMoM:c.prev?.Active_Customers})]}):e.jsx("div",{className:"text-center text-base-content/60",children:"No data"})]}),e.jsxs("div",{className:"rounded-selector p-4 h-full flex flex-col",children:[e.jsx("h4",{className:"font-semibold mb-2 text-center",children:"Internet Banking"}),i?.current?e.jsxs("div",{className:"flex flex-col gap-2 flex-1",children:[e.jsx(d,{title:"Volume",value:i.current.Volume.toLocaleString(),currentValueForMoM:i.current.Volume,previousValueForMoM:i.prev?.Volume}),e.jsx(d,{title:"Value",value:p(i.current.Value),currentValueForMoM:i.current.Value,previousValueForMoM:i.prev?.Value}),e.jsx(d,{title:"Active Customers",value:i.current.Active_Customers.toLocaleString(),currentValueForMoM:i.current.Active_Customers,previousValueForMoM:i.prev?.Active_Customers})]}):e.jsx("div",{className:"text-center text-base-content/60",children:"No data"})]})]})]})]})})},Y=({bankName:t,bankData:r,months:u,metrics:a})=>{const x=m.useMemo(()=>[...u].sort(),[u]),l=m.useRef(null),o=m.useMemo(()=>{const n=a.map(c=>({name:c.replace(/_/g," "),type:"line",smooth:!0,showSymbol:!1,data:r.map(i=>i.Infrastructure?.[c]??null)}));return{backgroundColor:"transparent",tooltip:{trigger:"axis",axisPointer:{type:"line"}},legend:{top:10,textStyle:{fontWeight:600}},grid:{left:40,right:20,top:50,bottom:40},xAxis:{type:"category",data:x,axisLabel:{rotate:45,fontWeight:500}},yAxis:{type:"value",axisLabel:{fontWeight:500}},series:n}},[r,a,x]);return e.jsx("div",{className:"card bg-base-100 shadow border-base-300 mb-8",children:e.jsxs("div",{className:"card-body",children:[e.jsxs("h3",{className:"card-title text-xl font-bold mb-2",children:[t," - Monthly Trends"]}),e.jsx($,{option:o,className:"w-full h-[400px]","aria-label":`${t} - Monthly trends for ${a.map(n=>n.replace(/_/g," ")).join(", ")}`,role:"img",tabIndex:0,onInit:n=>{l.current=n}})]})})},z=()=>{const{months:t,posBanksData:r,digitalBankingData:u}=G(),[a,x]=m.useState(""),[l,o]=m.useState("");m.useEffect(()=>{t.length>0&&!a&&x(t[0]);const s=r[a]||[];s.length>0?(!l||!s.some(v=>v.Bank_Name===l))&&o(s[0].Bank_Name):l&&o("")},[t,a,r]);const n=m.useMemo(()=>{const s=U(a,t),v=r[a]||[],w=v.find(h=>h.Bank_Name===l)||null,R=[...t].reverse().map(h=>r[h]?.find(f=>f.Bank_Name===l)||null).filter(h=>!!h),L=s&&r[s]?.find(h=>h.Bank_Name===l)||null,k=h=>{const f=h?u[h]||{}:{};return{neft:Array.isArray(f.NEFT)&&f.NEFT.find(M=>M.Bank_Name===l)||null,rtgs:Array.isArray(f.RTGS)&&f.RTGS.find(M=>M.Bank_Name===l)||null,mobile:Array.isArray(f.Mobile_Banking)&&f.Mobile_Banking.find(M=>M.Bank_Name===l)||null,internet:Array.isArray(f.Internet_Banking)&&f.Internet_Banking.find(M=>M.Bank_Name===l)||null}},j=k(a),_=k(s),E=v.map(h=>h.Bank_Name);return{prevMonth:s,banksForMonth:v,bankNames:E,selectedBankData:w,selectedBankTimeSeriesData:R,prevMonthBankData:L,digitalBanking:{neft:{current:j.neft,prev:_.neft},rtgs:{current:j.rtgs,prev:_.rtgs},mobile:{current:j.mobile,prev:_.mobile},internet:{current:j.internet,prev:_.internet}}}},[a,l,t,r,u]),{banksForMonth:c,selectedBankData:i,selectedBankTimeSeriesData:b,prevMonthBankData:I,digitalBanking:S}=n,N=m.useMemo(()=>c.map(s=>({label:s.Bank_Name,value:s.Bank_Name,shortName:s.Bank_Short_Name})),[c]),F=m.useMemo(()=>t.map(s=>({label:Q(s),value:s})),[t]),V=m.useMemo(()=>N.find(s=>s.value===l)?.shortName||"",[N,l]),y=m.useCallback(s=>{const v=N.find(w=>w.shortName===s)?.value||"";v&&o(v)},[N]),D=m.useMemo(()=>N.filter(s=>["HDFC","ICICI","SBI","AXIS","KOTAK","IDFCFirst","INDUSIND","HSBC","AMEX","AUSFB"].includes(s.shortName||"")).map(s=>s.shortName).filter(Boolean),[N]),P=m.useCallback(()=>{const s=t.indexOf(a);s<t.length-1&&x(t[s+1])},[t,a]),O=m.useCallback(()=>{const s=t.indexOf(a);s>0&&x(t[s-1])},[t,a]);return e.jsxs("div",{className:"container mx-auto p-4 sm:p-8",children:[i&&e.jsx("div",{className:"card bg-base-100 shadow-xl border border-base-300 mb-8",children:e.jsx("div",{className:"card-body",children:e.jsxs("div",{className:"flex flex-col sm:flex-row sm:items-start sm:justify-between",children:[e.jsxs("div",{className:"flex flex-col gap-2",children:[e.jsx(T,{options:N,selectedValue:l,onSelect:o,placeholder:"Select Bank",triggerClassName:"card-title text-4xl font-extrabold cursor-text",inputClassName:"card-title text-4xl font-extrabold focus:outline-none"}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx("div",{className:"badge badge-xl bg-base-300 p-2",children:i?.Bank_Type}),e.jsx("div",{className:"badge badge-xl bg-base-300 p-2",children:i?.Bank_Short_Name})]}),e.jsx("div",{className:"grid",children:e.jsx(W,{bankTypes:D,selected:V,onSelect:y,showAll:!1})})]}),e.jsxs("div",{className:"flex items-center gap-2 mt-4 sm:mt-0",children:[e.jsx("button",{className:"btn btn-ghost btn-sm",onClick:P,disabled:t.indexOf(a)===t.length-1,"aria-label":"Previous Month",title:"Previous Month",children:e.jsx(C,{icon:"arrow",className:"w-5 h-5 rotate-270"})}),e.jsx("div",{className:"flex-1 min-w-0 w-full",children:e.jsx(T,{options:F,selectedValue:a,onSelect:x,placeholder:"Select Month",triggerClassName:"badge badge-info badge-lg justify-center",inputClassName:"focus:outline-none"})}),e.jsx("button",{className:"btn btn-ghost btn-sm",onClick:O,disabled:t.indexOf(a)===0,"aria-label":"Next Month",title:"Next Month",children:e.jsx(C,{icon:"arrow",className:"w-5 h-5 rotate-90"})})]})]})})}),i?e.jsxs("article",{className:"grid gap-4",children:[e.jsx(X,{currentMonth:a,selectedBankData:i,prevMonthBankData:I,digitalBankingData:S}),e.jsx(Y,{bankData:b,months:t,metrics:["ATMs_CRMs","PoS","Credit_Cards","Debit_Cards"],bankName:l,digitalBankingData:u})]}):e.jsxs("div",{role:"alert",className:"alert alert-info shadow-lg",children:[e.jsx(C,{icon:"info",className:"shrink-0 w-6 h-6","aria-label":"Info"}),e.jsxs("div",{children:[e.jsx("h3",{className:"font-bold",children:"No Bank Selected or Data Unavailable!"}),e.jsx("div",{className:"text-sm",children:"Please select a month and then a bank from the dropdowns above to view its profile."})]})]})]})};export{z as default};
